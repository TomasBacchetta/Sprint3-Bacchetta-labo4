"use strict";(self.webpackChunkSprint2=self.webpackChunkSprint2||[]).push([[868],{8868:(T,l,s)=>{s.r(l),s.d(l,{ChatModule:()=>A});var i=s(6895),p=s(9051);class r{constructor(){this.mensaje="",this.usuario="",this.fecha=""}static toMensaje(o){let n=new r;return n.mensaje=o.mensaje,n.usuario=o.usuario,n.fecha=o.fecha,n}static validarTextoMensaje(o){return o.length>0&&o.length<100}}var e=s(4650),g=s(1995);let j=(()=>{class t{constructor(n){this.db=n,this.dbPath="chat",this.usuariosRef=n.collection(this.dbPath)}obtenerTodos(){return this.usuariosRef}crear(n){return this.usuariosRef.add(n)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(g.ST))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=s(5980),c=s(433);const m=".mensajePropio[_ngcontent-%COMP%]{background-color:#b4eeb4;text-align:right}.mensajeAjeno[_ngcontent-%COMP%]{background-color:#fff;text-align:left}body[_ngcontent-%COMP%]{width:700px}";let C=(()=>{class t{constructor(n){this.loginService=n,this.mensaje=new r,this.esUsuarioLogueado=!1,this.url=""}ngOnInit(){this.mensaje.usuario==this.loginService.obtenerUsuarioLogueado().correo&&(this.esUsuarioLogueado=!0)}fechaUnixToDate(n){let a=new Date(1e3*Number(n)).toString().split(" ");return a[1]+"-"+a[2]+"-"+a[4]}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(d.r))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-mensaje"]],inputs:{mensaje:"mensaje"},decls:4,vars:4,consts:[[3,"ngClass"]],template:function(n,a){1&n&&(e._UZ(0,"head"),e.TgZ(1,"body")(2,"p",0),e._uU(3),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("ngClass",a.esUsuarioLogueado?"mensajePropio":"mensajeAjeno"),e.xp6(1),e.lnq("",a.esUsuarioLogueado?"Yo":a.mensaje.usuario,"\xa0~\xa0",a.fechaUnixToDate(a.mensaje.fecha),"\xa0\xa0\xa0\xa0",a.mensaje.mensaje,"\n"))},dependencies:[i.mk],styles:[m,m]}),t})();function v(t,o){1&t&&e._UZ(0,"div",5)}function M(t,o){1&t&&e._UZ(0,"app-mensaje",6),2&t&&e.Q6J("mensaje",o.$implicit)}const f='.ventana-chat[_ngcontent-%COMP%]{max-height:500px;overflow-y:scroll}#cover-spin[_ngcontent-%COMP%]{position:fixed;width:100%;inset:0;background-color:#fff;z-index:9999}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}#cover-spin[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;left:48%;top:40%;width:40px;height:40px;border-style:solid;border-color:#000;border-top-color:transparent;border-width:4px;border-radius:50%;animation:spin .8s linear infinite}',b=[{path:"",component:(()=>{class t{constructor(n,a){this.db=n,this.usuarioLogueado=a,this.mensajes=[],this.spinner=!1,this.mensajeAEnviar="",this.error=!1}ngOnInit(){this.spinner=!0,this.db.obtenerTodos().snapshotChanges().subscribe(n=>{this.mensajes=[],n.forEach(a=>{this.mensajes.push(r.toMensaje(a.payload.doc.data())),this.mensajes.sort((u,h)=>u.fecha>h.fecha?1:u.fecha<h.fecha?-1:0)}),this.spinner=!1})}enviarMensaje(){if(this.error=!1,r.validarTextoMensaje(this.mensajeAEnviar)){let n=new r;n.fecha=parseInt(((new Date).getTime()/1e3).toFixed(0)).toString(),n.mensaje=this.mensajeAEnviar,n.usuario=this.usuarioLogueado.obtenerUsuarioLogueado().correo,this.db.crear(Object.assign({},n)),this.mensajeAEnviar=""}else this.error=!0}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(j),e.Y36(d.r))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-chat"]],decls:8,vars:4,consts:[["id","cover-spin",4,"ngIf"],[1,"ventana-chat"],[3,"mensaje",4,"ngFor","ngForOf"],["type","text",3,"placeholder","ngModel","ngModelChange"],[3,"click"],["id","cover-spin"],[3,"mensaje"]],template:function(n,a){1&n&&(e._UZ(0,"head"),e.TgZ(1,"body"),e.YNc(2,v,1,0,"div",0),e.TgZ(3,"div",1),e.YNc(4,M,1,1,"app-mensaje",2),e.qZA(),e.TgZ(5,"input",3),e.NdJ("ngModelChange",function(h){return a.mensajeAEnviar=h}),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return a.enviarMensaje()}),e._uU(7,"Enviar"),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("ngIf",a.spinner),e.xp6(2),e.Q6J("ngForOf",a.mensajes),e.xp6(1),e.s9C("placeholder",a.error?"TEXTO INV\xc1LIDO":"Ingrese mensaje"),e.Q6J("ngModel",a.mensajeAEnviar))},dependencies:[i.sg,i.O5,c.Fj,c.JJ,c.On,C],styles:[f,f]}),t})()}];let y=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[p.Bz.forChild(b),p.Bz]}),t})(),A=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[i.ez,y,c.u5]}),t})()}}]);